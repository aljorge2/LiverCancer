"0","metadata <- read.table(""~/Desktop/ResearchProjects/LiverCancerProject/Metadata/metadata_for_de.csv"", row.names=1,header=TRUE, sep="","") #changing the name of the file"
"0","tumorAdjacentExp <- read.table(""~/Desktop/ResearchProjects/LiverCancerProject/Metadata/japan_all_samples_salmon_expression_counts.txt"", row.names = 1, header=TRUE) #changing the name of the file "
"0","colnames(tumorAdjacentExp) <- gsub(""\\."", ""-"", colnames(tumorAdjacentExp)) #changing the column names "
"0",""
"0","# Importing gene annotations"
"0","#genes <- read.table(""gencode.v25.chr_patch_hapl_scaff.annotation.bed"", header=FALSE, sep=""\t"")"
"0","genes <- read.table(""~/Desktop/ResearchProjects/LiverCancerProject/Metadata/gencodeTranscripts.txt"", header=TRUE, sep=""\t"")"
"0","genes <- data.frame(genes)"
"0","tumorAdjacentExp <- tumorAdjacentExp[rownames(tumorAdjacentExp) %in% genes$GENEID ,]"
"0","genes <- genes[match(rownames(tumorAdjacentExp), genes$GENEID),]"
"0","# Calculating gene length, this is needed for calculating the FPKM values"
"0","genes$length <- with(genes, end - start)"
"0",""
"0","# Removing Samples due to low quality"
"0","metadata <- metadata[!(metadata$ID == ""RK023"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK106"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK113"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK135"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK105"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK116"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK066"") , ]"
"0","metadata <- metadata[!(metadata$ID == ""RK096"") , ]"
"0",""
"0","#Removing both and NBNC samples"
"0","metadata <- metadata[!(metadata$Virus_infection == ""NBNC""), ]"
"0","metadata <- metadata[!(metadata$Virus_infection == ""both""), ]"
"0",""
"0","# Subsetting and ordering metadata to match the count matrix"
"0","tumorAdjacentExpSubset <- tumorAdjacentExp[,colnames(tumorAdjacentExp) %in% metadata$sampleid]"
"0","metadataSubset <- metadata[metadata$sampleid %in% colnames(tumorAdjacentExpSubset),]"
"0","metadataSubset <- metadataSubset[match(colnames(tumorAdjacentExpSubset), metadataSubset$sampleid),]"
"0","rownames(metadataSubset) <- metadataSubset$sampleid"
"0",""
"0","# Adding tissue type, converting categorical variables to factors"
"0","metadataSubset$tumor <- as.numeric(grepl('tumor', metadataSubset$sampleid, ignore.case=T))"
"0",""
"0","#Swapping lesion type for sample RK169"
"0","metadataSubset[""RK169-tumor-XY"",""tumor""] <- 0"
"0","metadataSubset[""RK169-adjacent-XY"",""tumor""] <- 1"
"0",""
"0","#Changing rownames to match swapped lesion type"
"0","rownames(metadataSubset)[rownames(metadataSubset)==""RK169-tumor-XY""] <- ""RK169_adjacent-XY"""
"0","rownames(metadataSubset)[rownames(metadataSubset)==""RK169-adjacent-XY""] <- ""RK169_tumor-XY"""
"0","rownames(metadataSubset)[rownames(metadataSubset)==""RK169_adjacent-XY""] <- ""RK169-adjacent-XY"""
"0",""
"0","rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)==""RK169-tumor-XY""] <- ""RK169_adjacent-XY"""
"0","rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)==""RK169-adjacent-XY""] <- ""RK169_tumor-XY"""
"0","rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)==""RK169_adjacent-XY""] <- ""RK169-adjacent-XY"""
"0",""
"0","#Swapping lesion type for sample RK065"
"0","metadataSubset[""RK065-tumor-XX"",""tumor""] <- 0"
"0","metadataSubset[""RK065-adjacent-XX"",""tumor""] <- 1"
"0",""
"0","#Changing rownames in metadata to match swapped lesion type"
"0","rownames(metadataSubset)[rownames(metadataSubset)==""RK065-tumor-XY""] <- ""RK065_adjacent-XY"""
"0","rownames(metadataSubset)[rownames(metadataSubset)==""RK065-adjacent-XY""] <- ""RK065_tumor-XY"""
"0","rownames(metadataSubset)[rownames(metadataSubset)==""RK065_adjacent-XY""] <- ""RK065-adjacent-XY"""
"0",""
"0","rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)==""RK065-tumor-XY""] <- ""RK065_adjacent-XY"""
"0","rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)==""RK065-adjacent-XY""] <- ""RK065_tumor-XY"""
"0","rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)==""RK065_adjacent-XY""] <- ""RK065-adjacent-XY"""
"0",""
"0","metadataSubset$gender_tissue <- paste(metadataSubset$Gender, metadataSubset$tumor, sep=""_"")"
"0","metadataSubset$gender_tissue_viral <- paste(metadataSubset$gender_tissue, metadataSubset$Virus_infection, sep=""_"")"
"0","metadataSubset$library_type <- metadataSubset$strandedness"
"0","metadataSubset$library_type <- factor(metadataSubset$library_type)"
"0","metadataSubset$tumor <- factor(metadataSubset$tumor)"
"0","metadataSubset$Ta <- factor(metadataSubset$Ta)"
"0","metadataSubset$Portal_vein_invasion <- factor(metadataSubset$Portal_vein_invasion)"
"0","metadataSubset$Hepatic_vein_invasion <- factor(metadataSubset$Hepatic_vein_invasion)"
"0","metadataSubset$Bile_duct_invasion <- factor(metadataSubset$Bile_duct_invasion)"
"0","metadataSubset$Liver_fibrosisc <- factor(metadataSubset$Liver_fibrosisc)"
"0","metadataSubset$Prognosis <- factor(metadataSubset$Prognosis)"
"0",""
"0","write.csv(x=metadataSubset,file=""~/Desktop/ResearchProjects/LiverCancerProject/DEA_removed_samples/MedicalCovariateAnalysis/data/metadataSubset.csv"",row.names=FALSE)"
