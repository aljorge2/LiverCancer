---
title: "X degenerate FPKM expression"
author: "Annika Jorgensen"
date: "2023-10-17"
output: html_document
---

**README**

**Results**
### **Libraries**
The first chunk of code is dedicated to installing the libraries. These libraries are to help execute the differential analysis and helps visualize the data. The code was not included for concision.  
```{r Libraries, include=FALSE}

library(RColorBrewer)
library(matrixStats)
library(ggplot2)
library(edgeR)
library(DESeq2)
library(limma)
library(doParallel)
library(variancePartition)
library(org.Hs.eg.db)
library(clusterProfiler)
library(GOSemSim)
library(biomaRt)
library(UpSetR)
library(VennDiagram)
library(ggrepel)
library(dplyr)
library(stringr)
library(forcats)
library(stats)
library(gridExtra)
library(tidyverse)

setwd('~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples')
```

**Read in data**

This code is where you read in all the data files that are going to be used in the script. The data is also converted into a variety of variables that makes the data easier to handle. The data is also cleaned up to make sure the analysis done later is accurate and precise. 
```{r Reading_in_data}
metadata <- read.table("~/Desktop/ResearchProjects/LiverCancer/Metadata/metadata_for_de.csv", row.names=1,header=TRUE, sep=",") #changing the name of the file
tumorAdjacentExp <- read.table("~/Desktop/ResearchProjects/LiverCancer/Metadata/japan_all_samples_salmon_expression_counts.txt", row.names = 1, header=TRUE) #changing the name of the file 
colnames(tumorAdjacentExp) <- gsub("\\.", "-", colnames(tumorAdjacentExp)) #changing the column names 

# Importing gene annotations
#genes <- read.table("gencode.v25.chr_patch_hapl_scaff.annotation.bed", header=FALSE, sep="\t")
genes <- read.table("~/Desktop/ResearchProjects/LiverCancer/Metadata/gencodeTranscripts.txt", header=TRUE, sep="\t")
genes <- data.frame(genes)
tumorAdjacentExp <- tumorAdjacentExp[rownames(tumorAdjacentExp) %in% genes$GENEID ,]
genes <- genes[match(rownames(tumorAdjacentExp), genes$GENEID),]
# Calculating gene length, this is needed for calculating the FPKM values
genes$length <- with(genes, end - start)

# Removing Samples due to low quality
metadata <- metadata[!(metadata$ID == "RK023") , ]
metadata <- metadata[!(metadata$ID == "RK106") , ]
metadata <- metadata[!(metadata$ID == "RK113") , ]
metadata <- metadata[!(metadata$ID == "RK135") , ]
metadata <- metadata[!(metadata$ID == "RK105") , ]
metadata <- metadata[!(metadata$ID == "RK116") , ]
metadata <- metadata[!(metadata$ID == "RK066") , ]
metadata <- metadata[!(metadata$ID == "RK096") , ]

#Removing both and NBNC samples
metadata <- metadata[!(metadata$Virus_infection == "NBNC"), ]
metadata <- metadata[!(metadata$Virus_infection == "both"), ]

# Subsetting and ordering metadata to match the count matrix
tumorAdjacentExpSubset <- tumorAdjacentExp[,colnames(tumorAdjacentExp) %in% metadata$sampleid]
metadataSubset <- metadata[metadata$sampleid %in% colnames(tumorAdjacentExpSubset),]
metadataSubset <- metadataSubset[match(colnames(tumorAdjacentExpSubset), metadataSubset$sampleid),]
rownames(metadataSubset) <- metadataSubset$sampleid

# Adding tissue type, converting categorical variables to factors
metadataSubset$tumor <- as.numeric(grepl('tumor', metadataSubset$sampleid, ignore.case=T))

#Swapping lesion type for sample RK169
metadataSubset["RK169-tumor-XY","tumor"] <- 0
metadataSubset["RK169-adjacent-XY","tumor"] <- 1

#Changing rownames to match swapped lesion type
rownames(metadataSubset)[rownames(metadataSubset)=="RK169-tumor-XY"] <- "RK169_adjacent-XY"
rownames(metadataSubset)[rownames(metadataSubset)=="RK169-adjacent-XY"] <- "RK169_tumor-XY"
rownames(metadataSubset)[rownames(metadataSubset)=="RK169_adjacent-XY"] <- "RK169-adjacent-XY"

rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)=="RK169-tumor-XY"] <- "RK169_adjacent-XY"
rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)=="RK169-adjacent-XY"] <- "RK169_tumor-XY"
rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)=="RK169_adjacent-XY"] <- "RK169-adjacent-XY"

#Swapping lesion type for sample RK065
metadataSubset["RK065-tumor-XX","tumor"] <- 0
metadataSubset["RK065-adjacent-XX","tumor"] <- 1

#Changing rownames in metadata to match swapped lesion type
rownames(metadataSubset)[rownames(metadataSubset)=="RK065-tumor-XY"] <- "RK065_adjacent-XY"
rownames(metadataSubset)[rownames(metadataSubset)=="RK065-adjacent-XY"] <- "RK065_tumor-XY"
rownames(metadataSubset)[rownames(metadataSubset)=="RK065_adjacent-XY"] <- "RK065-adjacent-XY"

rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)=="RK065-tumor-XY"] <- "RK065_adjacent-XY"
rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)=="RK065-adjacent-XY"] <- "RK065_tumor-XY"
rownames(tumorAdjacentExpSubset)[rownames(tumorAdjacentExpSubset)=="RK065_adjacent-XY"] <- "RK065-adjacent-XY"

metadataSubset$gender_tissue <- paste(metadataSubset$Gender, metadataSubset$tumor, sep="_")
metadataSubset$gender_tissue_viral <- paste(metadataSubset$gender_tissue, metadataSubset$Virus_infection, sep="_")
metadataSubset$library_type <- metadataSubset$strandedness
metadataSubset$library_type <- factor(metadataSubset$library_type)
metadataSubset$tumor <- factor(metadataSubset$tumor)
metadataSubset$Ta <- factor(metadataSubset$Ta)
metadataSubset$Portal_vein_invasion <- factor(metadataSubset$Portal_vein_invasion)
metadataSubset$Hepatic_vein_invasion <- factor(metadataSubset$Hepatic_vein_invasion)
metadataSubset$Bile_duct_invasion <- factor(metadataSubset$Bile_duct_invasion)
metadataSubset$Liver_fibrosisc <- factor(metadataSubset$Liver_fibrosisc)
metadataSubset$Prognosis <- factor(metadataSubset$Prognosis)
```

```{r DGE Object}
# Creating the DGEList object
dge <- DGEList(counts=tumorAdjacentExpSubset, genes=genes)
colnames(dge) <- colnames(tumorAdjacentExpSubset)
dge$samples$sex <- metadataSubset$Gender
dge$samples$viral <- factor(metadataSubset$Virus_infection)
dge$samples$ID <- metadataSubset$ID
dge$samples$tumor <- metadataSubset$tumor
dge$samples$gender_tissue <- metadataSubset$gender_tissue
dge$samples$gender_tissue_viral <- metadataSubset$gender_tissue_viral
dge$samples$library_type <- metadataSubset$library_type
dge$samples$edmonson_grade <- metadataSubset$Edmondson_grade
dge$samples$Ta <- metadataSubset$Ta
dge$samples$survival <- metadataSubset$Overall_survival_month

# Inspecting the N of samples in each group
table(dge$samples$gender_tissue_viral)
```

```{r fpkm}
# ======================================
# Filtering expression data
# ======================================

# Keeping genes that have a mean FPKM of at least 0.5 in at least one of the groups under investigation 
fpkm <- rpkm(dge, gene.length=dge$genes$length)

M_1_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="M_1_HBV")],1,mean,na.rm=TRUE)
M_0_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="M_0_HBV")],1,mean,na.rm=TRUE)
M_1_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="M_1_HCV")],1,mean,na.rm=TRUE)
M_0_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="M_0_HCV")],1,mean,na.rm=TRUE)

F_1_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="F_1_HBV")],1,mean,na.rm=TRUE)
F_0_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="F_0_HBV")],1,mean,na.rm=TRUE)
F_1_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="F_1_HCV")],1,mean,na.rm=TRUE)
F_0_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral=="F_0_HCV")],1,mean,na.rm=TRUE)

keep <- (M_1_HBV_mean_fpkm > 0.5 | M_0_HBV_mean_fpkm > 0.5 | 
           M_1_HCV_mean_fpkm > 0.5 | M_0_HCV_mean_fpkm > 0.5 |
           F_1_HBV_mean_fpkm > 0.5 | F_0_HBV_mean_fpkm > 0.5 |
           F_1_HCV_mean_fpkm > 0.5 | F_0_HCV_mean_fpkm > 0.5 )

dge <- dge[keep,,keep.lib.sizes=FALSE]

# N of genes retained after filtering
dim(dge$genes)
```

**Scraps**
```{r pulling out genes}

# Pulling X degenerate expression data from dge variable into individual variables

dge <- as.data.frame(dge)
gene0 <- dge[which(dge$gene_name=="KDM5D"),]
gene1 <- dge[which(dge$gene_name=="DDX3Y"),]
gene2 <- dge[which(dge$gene_name=="EIF1AY"),]
gene3 <- dge[which(dge$gene_name=="TXLNGY"),]
gene4 <- dge[which(dge$gene_name=="TSPY1"),]
gene5 <- dge[which(dge$gene_name=="AR"),]
gene6 <- dge[which(dge$gene_name=="XIST"),]

#creating data frame of all genes we will be working with
xDegenerateExpression<- rbind(gene0,gene1,gene2,gene3,gene4)
rownames(xDegenerateExpression) <- xDegenerateExpression$gene_name
xDegenerateExpression <- subset(xDegenerateExpression, select = -c(chr, start, end, TXNAME, GENEID, length,gene_name))
xDegenerateExpression<- t(xDegenerateExpression)
xDegenerateExpression <- as.data.frame(xDegenerateExpression)
#making the gene names the rownames 
#rownames(xDegenerateExpression) <- xDegenerateExpression$gene_name

#subsetting out all columns that are not expression data
 # xDegenerateExpression <- as.data.frame(t(xDegenerateExpression))

#subsetting by tumor 
Tumor_expressionData <- xDegenerateExpression[grepl("tumor",rownames(xDegenerateExpression),fixed=TRUE),]
Tumor_expressionData <- as.data.frame(Tumor_expressionData)
Tumor_expressionData<- t(Tumor_expressionData)
Tumor_expressionData <- as.data.frame(Tumor_expressionData)
write.csv(Tumor_expressionData,file = "~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/GeneExpressionPlots/data/TumorExpressionData5genes.csv")

Adjacent_expressionData <- xDegenerateExpression[grepl("adjacent",rownames(xDegenerateExpression),fixed=TRUE),]
Adjacent_expressionData <- as.data.frame(Adjacent_expressionData)
Adjacent_expressionData<- t(Adjacent_expressionData)
Adjacent_expressionData <- as.data.frame(Adjacent_expressionData)
write.csv(Adjacent_expressionData,file = "~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/GeneExpressionPlots/data/TumorAdjExpressionData5genes.csv")
#Creating Names column
#for (i in 1:dim(Tumor_expressionData)[1]) {
#    Tumor_expressionData$Names[i] = substr(row.names(Tumor_expressionData)[i],3,5)
#}
#Tumor_expressionData$group<- 1:149
```

```{r test}
#test <- Tumor_expressionData[1,]
#test <- t(test)
#test <- as.data.frame(test)
#test$gene <- rownames(test)
#colnames(test) <- c("RK002","gene")
#ggplot(test, aes(x=gene, y=RK002)) + geom_line() + geom_point()
#ggplot(data=Tumor_expressionData,aes(x=gene, y=Names, group=group)) +geom_line() + geom_point()
```

```{r scatterplot} 
geneXaxis<- 1:5

pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/SamplesXdegenerateGenesPlot.pdf", width=12, height=12)
plot(geneXaxis,Tumor_expressionData$`RK002-tumor-XY`,main="FPKM of all Tumor Samples for KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1",type="b",ylab="FPKM",xlab="KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1")

for (i in colnames(Tumor_expressionData)) {
  lines(geneXaxis,Tumor_expressionData[,i],type="l",col=1:149)
  text(geneXaxis, Tumor_expressionData[,i],
     labels = colnames(Tumor_expressionData),
     cex = 0.6, pos = 4, col = "red",)
}
dev.off()

pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/SamplesXdegenerateGenesPlot_adjacent.pdf", width=12, height=12)
plot(geneXaxis,Adjacent_expressionData$`RK002-adjacent-XY`,main="FPKM of all Tumor Samples for KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1",type="b",ylab="FPKM",xlab="KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1")

for (i in colnames(Adjacent_expressionData)) {
  lines(geneXaxis,Adjacent_expressionData[,i],type="b")
  text(geneXaxis, Adjacent_expressionData[,i],
     labels = colnames(Adjacent_expressionData),
     cex = 0.6, pos = 4, col = "red",)
}
dev.off()
#for( i in colnames(Tumor_expressionData)) {
  
  #plot(geneXaxis, Tumor_expressionData[,i],type="b")
  
  
  
#}


pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/SamplesXdegenerateGenesPlotAxisLim.pdf", width=12, height=12)
plot(geneXaxis,Tumor_expressionData$`RK002-tumor-XY`,main="FPKM of all Tumor Samples for KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1",type="b",ylab="FPKM",xlab="KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1", ylim=c(0,100))
for (i in colnames(Tumor_expressionData)) {
  lines(geneXaxis,Tumor_expressionData[,i],type="b")
  text(geneXaxis, Tumor_expressionData[,i],
    labels = colnames(Tumor_expressionData),
     cex = 1, pos = 4,col = "red",adj=0.5)
}
dev.off()

pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/SamplesXdegenerateGenesPlotAxisLim_adjacent.pdf", width=12, height=12)
plot(geneXaxis,Adjacent_expressionData$`RK002-adjacent-XY`,main="FPKM of all Tumor Samples for KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1",type="b",ylab="FPKM",xlab="KDM5D, DDX3Y, EIF1AY, TXLNGY, TSPY1", ylim=c(0,100))

for (i in colnames(Adjacent_expressionData)) {
  lines(geneXaxis,Adjacent_expressionData[,i],type="b")
  text(geneXaxis, Adjacent_expressionData[,i],
     labels = colnames(Adjacent_expressionData),
     cex = 0.6, pos = 4, col = "red",)
}
dev.off()
#creating scatterplot
#ggplot(gene0,aes(x=, y=Expression)) + geom_point()
```

```{r another column}
#creating data frame for all samples with FPKM under 100

#data frame containing sample 3 expression
dataFiltered<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,2],Names=c("003","003","003","003","003")))
rownames(dataFiltered)<-1:5

#creating data frame with sample 16 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,8],Names=c("016","016","016","016","016")))
rownames(newRow)<-1:5

#combining sample 16 and sample 3
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 22 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,12],Names=c("022","022","022","022","022")))
rownames(newRow)<-1:5

#combining sample 22 and sample 3,16
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 25 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,14],Names=c("025","025","025","025","025")))
rownames(newRow)<-1:5

#combining sample 25 and sample 3,16,22
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 28 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,17],Names=c("028","028","028","028","028")))
rownames(newRow)<-1:5

#combining sample 28 and sample 3,16,22,25
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 38 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,24],Names=c("038","038","038","038","038")))
rownames(newRow)<-1:5

#combining sample 38 and sample 3,16,22,25,28
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 40 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,25],Names=c("040","040","040","040","040")))
rownames(newRow)<-1:5

#combining sample 40 and sample 3,16,22,25,28,38
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 44 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,28],Names=c("044","044","044","044","044")))
rownames(newRow)<-1:5

#combining sample 44 and sample 3,16,22,25,28,38,40
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 47 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,29],Names=c("047","047","047","047","047")))
rownames(newRow)<-1:5

#combining sample 47 and sample 3,16,22,25,28,38,40,44
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 64 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,43],Names=c("064","064","064","064","064")))
rownames(newRow)<-1:5

#combining sample 64 and sample 3,16,22,25,28,38,40,44,47
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 65 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,44],Names=c("065","065","065","065","065")))
rownames(newRow)<-1:5

#combining sample 65 and sample 3,16,22,25,28,38,40,44,47,64
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 68 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,45],Names=c("068","068","068","068","068")))
rownames(newRow)<-1:5

#combining sample 68 and sample 3,16,22,25,28,38,40,44,47,64,65
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 71 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,46],Names=c("071","071","071","071","071")))
rownames(newRow)<-1:5

#combining sample 71 and sample 3,16,22,25,28,38,40,44,47,64,65,68
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 72 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,47],Names=c("072","072","072","072","072")))
rownames(newRow)<-1:5

#combining sample 72 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 83 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,53],Names=c("083","083","083","083","083")))
rownames(newRow)<-1:5

#combining sample 83 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 95 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,59],Names=c("095","095","095","095","095")))
rownames(newRow)<-1:5

#combining sample 95 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 98 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,60],Names=c("098","098","098","098","098")))
rownames(newRow)<-1:5

#combining sample 98 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 100 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,61],Names=c("100","100","100","100","100")))
rownames(newRow)<-1:5

#combining sample 100 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 107 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,66],Names=c("107","107","107","107","107")))
rownames(newRow)<-1:5

#combining sample 107 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 115 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,69],Names=c("115","115","115","115","115")))
rownames(newRow)<-1:5

#combining sample 115 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 117 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,70],Names=c("117","117","117","117","117")))
rownames(newRow)<-1:5

#combining sample 117 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 119 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,72],Names=c("119","119","119","119","119")))
rownames(newRow)<-1:5

#combining sample 119 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 141 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,82],Names=c("141","141","141","141","141")))
rownames(newRow)<-1:5

#combining sample 141 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 155 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,90],Names=c("155","155","155","155","155")))
rownames(newRow)<-1:5

#combining sample 155 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 163 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,95],Names=c("163","163","163","163","163")))
rownames(newRow)<-1:5

#combining sample 163 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 172 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,99],Names=c("172","172","172","172","172")))
rownames(newRow)<-1:5

#combining sample 172 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 178 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,102],Names=c("178","178","178","178","178")))
rownames(newRow)<-1:5

#combining sample 178 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 186 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,105],Names=c("186","186","186","186","186")))
rownames(newRow)<-1:5

#combining sample 186 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 193 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,108],Names=c("193","193","193","193","193")))
rownames(newRow)<-1:5

#combining sample 193 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 198 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,110],Names=c("198","198","198","198","198")))
rownames(newRow)<-1:5

#combining sample 198 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 199 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,111],Names=c("199","199","199","199","199")))
rownames(newRow)<-1:5

#combining sample 199 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 202 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,113],Names=c("202","202","202","202","202")))
rownames(newRow)<-1:5

#combining sample 202 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 207 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,115],Names=c("207","207","207","207","207")))
rownames(newRow)<-1:5

#combining sample 207 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 211 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,118],Names=c("211","211","211","211","211")))
rownames(newRow)<-1:5

#combining sample 211 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 216 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,122],Names=c("216","216","216","216","216")))
rownames(newRow)<-1:5

#combining sample 216 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 219 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,123],Names=c("219","219","219","219","219")))
rownames(newRow)<-1:5

#combining sample 219 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 222 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,124],Names=c("222","222","222","222","222")))
rownames(newRow)<-1:5

#combining sample 222 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 230 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,128],Names=c("230","230","230","230","230")))
rownames(newRow)<-1:5

#combining sample 230 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219,222
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 232 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,129],Names=c("232","232","232","232","232")))
rownames(newRow)<-1:5

#combining sample 232 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219,222,230
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 236 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,131],Names=c("236","236","236","236","236")))
rownames(newRow)<-1:5

#combining sample 236 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219,222,230,232
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 243 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,134],Names=c("243","243","243","243","243")))
rownames(newRow)<-1:5

#combining sample 243 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219,222,230,232,236
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 266 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,143],Names=c("266","266","266","266","266")))
rownames(newRow)<-1:5

#combining sample 266 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219,222,230,232,236,243
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 284 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,147],Names=c("284","284","284","284","284")))
rownames(newRow)<-1:5

#combining sample 284 and sample 3,16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,117,119,141,155,163,172,178,186,193,198,                                  #199,202,207,211,216,219,222,230,232,236,243,266
dataFiltered<- rbind(dataFiltered,newRow)
```

```{r Plotting FPKM less than 100}
#changing Expression values to be numeric 
dataFiltered$Expression<- as.numeric(dataFiltered$Expression)

#plotting all samples with FPKM under 100
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot

#outputting plot to PDF
pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/FPKM_sampleNamesPlots/100FPKM_XdegenerateGeneExpressionPlot.pdf", width=12, height=12)
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot
dev.off()
```
creating data frame for all samples with FPKM under 20
```{r data frame FPKM less than 20}
#creating data frame for all samples with FPKM under 20


#creating data frame with sample 16 expression
dataFiltered<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,8],Names=c("016","016","016","016","016")))
rownames(dataFiltered)<-1:5

#creating data frame with sample 22 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,12],Names=c("022","022","022","022","022")))
rownames(newRow)<-1:5

#combining sample 22 and sample 16
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 25 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,14],Names=c("025","025","025","025","025")))
rownames(newRow)<-1:5

#combining sample 25 and sample 16,22
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 28 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,17],Names=c("028","028","028","028","028")))
rownames(newRow)<-1:5

#combining sample 28 and sample 16,22,25
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 38 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,24],Names=c("038","038","038","038","038")))
rownames(newRow)<-1:5

#combining sample 38 and sample 16,22,25,28
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 40 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,25],Names=c("040","040","040","040","040")))
rownames(newRow)<-1:5

#combining sample 40 and sample 16,22,25,28,38
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 44 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,28],Names=c("044","044","044","044","044")))
rownames(newRow)<-1:5

#combining sample 44 and sample 16,22,25,28,38,40
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 47 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,29],Names=c("047","047","047","047","047")))
rownames(newRow)<-1:5

#combining sample 47 and sample 16,22,25,28,38,40,44
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 64 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,43],Names=c("064","064","064","064","064")))
rownames(newRow)<-1:5

#combining sample 64 and sample 16,22,25,28,38,40,44,47
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 65 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,44],Names=c("065","065","065","065","065")))
rownames(newRow)<-1:5

#combining sample 65 and sample 16,22,25,28,38,40,44,47,64
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 68 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,45],Names=c("068","068","068","068","068")))
rownames(newRow)<-1:5

#combining sample 68 and sample 16,22,25,28,38,40,44,47,64,65
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 71 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,46],Names=c("071","071","071","071","071")))
rownames(newRow)<-1:5

#combining sample 71 and sample 16,22,25,28,38,40,44,47,64,65,68
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 72 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,47],Names=c("072","072","072","072","072")))
rownames(newRow)<-1:5

#combining sample 72 and sample 16,22,25,28,38,40,44,47,64,65,68,71
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 83 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,53],Names=c("083","083","083","083","083")))
rownames(newRow)<-1:5

#combining sample 83 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 95 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,59],Names=c("095","095","095","095","095")))
rownames(newRow)<-1:5

#combining sample 95 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 98 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,60],Names=c("098","098","098","098","098")))
rownames(newRow)<-1:5

#combining sample 98 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 100 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,61],Names=c("100","100","100","100","100")))
rownames(newRow)<-1:5

#combining sample 100 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 107 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,66],Names=c("107","107","107","107","107")))
rownames(newRow)<-1:5

#combining sample 107 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 115 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,69],Names=c("115","115","115","115","115")))
rownames(newRow)<-1:5

#combining sample 115 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 119 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,72],Names=c("119","119","119","119","119")))
rownames(newRow)<-1:5

#combining sample 119 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 141 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,82],Names=c("141","141","141","141","141")))
rownames(newRow)<-1:5

#combining sample 141 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 155 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,90],Names=c("155","155","155","155","155")))
rownames(newRow)<-1:5

#combining sample 155 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 163 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,95],Names=c("163","163","163","163","163")))
rownames(newRow)<-1:5

#combining sample 163 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 172 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,99],Names=c("172","172","172","172","172")))
rownames(newRow)<-1:5

#combining sample 172 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 178 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,102],Names=c("178","178","178","178","178")))
rownames(newRow)<-1:5

#combining sample 178 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 186 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,105],Names=c("186","186","186","186","186")))
rownames(newRow)<-1:5

#combining sample 186 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 193 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,108],Names=c("193","193","193","193","193")))
rownames(newRow)<-1:5

#combining sample 193 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 198 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,110],Names=c("198","198","198","198","198")))
rownames(newRow)<-1:5

#combining sample 198 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 199 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,111],Names=c("199","199","199","199","199")))
rownames(newRow)<-1:5

#combining sample 199 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 202 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,113],Names=c("202","202","202","202","202")))
rownames(newRow)<-1:5

#combining sample 202 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 207 expression
#newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,115],Names=c("207","207","207","207","207")))
#rownames(newRow)<-1:5

#combining sample 207 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202
#dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 211 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,118],Names=c("211","211","211","211","211")))
rownames(newRow)<-1:5

#combining sample 211 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                 #,207
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 216 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,122],Names=c("216","216","216","216","216")))
rownames(newRow)<-1:5

#combining sample 216 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198 199,202                                  #,207,211
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 219 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,123],Names=c("219","219","219","219","219")))
rownames(newRow)<-1:5

#combining sample 219 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 222 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,124],Names=c("222","222","222","222","222")))
rownames(newRow)<-1:5

#combining sample 222 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 230 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,128],Names=c("230","230","230","230","230")))
rownames(newRow)<-1:5

#combining sample 230 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 232 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,129],Names=c("232","232","232","232","232")))
rownames(newRow)<-1:5

#combining sample 232 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 236 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,131],Names=c("236","236","236","236","236")))
rownames(newRow)<-1:5

#combining sample 236 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 243 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,134],Names=c("243","243","243","243","243")))
rownames(newRow)<-1:5

#combining sample 243 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232,236
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 266 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,143],Names=c("266","266","266","266","266")))
rownames(newRow)<-1:5

#combining sample 266 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232,236,243
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 284 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,147],Names=c("284","284","284","284","284")))
rownames(newRow)<-1:5

#combining sample 284 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232,236,243,266
dataFiltered<- rbind(dataFiltered,newRow)
```

```{r Plotting FPKM 20 or less}
#changing Expression values to be numeric 
dataFiltered$Expression<- as.numeric(dataFiltered$Expression)

#plotting all samples with FPKM 20 or less
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot

#outputting plot to PDF
pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/FPKM_sampleNamesPlots/20FPKM_XdegenerateGeneExpressionPlot.pdf", width=12, height=12)
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot
dev.off()
```

```{r zero FPKM investigation}
#creating data frame for all samples with FPKM under 20


#creating data frame with sample 16 expression
dataFiltered<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,8],Names=c("016","016","016","016","016")))
rownames(dataFiltered)<-1:5

#creating data frame with sample 22 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,12],Names=c("022","022","022","022","022")))
rownames(newRow)<-1:5

#combining sample 22 and sample 16
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 25 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,14],Names=c("025","025","025","025","025")))
rownames(newRow)<-1:5

#combining sample 25 and sample 16,22
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 28 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,17],Names=c("028","028","028","028","028")))
rownames(newRow)<-1:5

#combining sample 28 and sample 16,22,25
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 38 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,24],Names=c("038","038","038","038","038")))
rownames(newRow)<-1:5

#combining sample 38 and sample 16,22,25,28
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 40 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,25],Names=c("040","040","040","040","040")))
rownames(newRow)<-1:5

#combining sample 40 and sample 16,22,25,28,38
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 44 expression
#newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,28],Names=c("044","044","044","044","044")))
#rownames(newRow)<-1:5

#combining sample 44 and sample 16,22,25,28,38,40
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 47 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,29],Names=c("047","047","047","047","047")))
rownames(newRow)<-1:5

#combining sample 47 and sample 16,22,25,28,38,40,44
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 64 expression
newRow<-  as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,43],Names=c("064","064","064","064","064")))
rownames(newRow)<-1:5

#combining sample 64 and sample 16,22,25,28,38,40,44,47
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 65 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,44],Names=c("065","065","065","065","065")))
rownames(newRow)<-1:5

#combining sample 65 and sample 16,22,25,28,38,40,44,47,64
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 68 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,45],Names=c("068","068","068","068","068")))
rownames(newRow)<-1:5

#combining sample 68 and sample 16,22,25,28,38,40,44,47,64,65
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 71 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,46],Names=c("071","071","071","071","071")))
rownames(newRow)<-1:5

#combining sample 71 and sample 16,22,25,28,38,40,44,47,64,65,68
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 72 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,47],Names=c("072","072","072","072","072")))
rownames(newRow)<-1:5

#combining sample 72 and sample 16,22,25,28,38,40,44,47,64,65,68,71
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 83 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,53],Names=c("083","083","083","083","083")))
rownames(newRow)<-1:5

#combining sample 83 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 95 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,59],Names=c("095","095","095","095","095")))
rownames(newRow)<-1:5

#combining sample 95 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 98 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,60],Names=c("098","098","098","098","098")))
rownames(newRow)<-1:5

#combining sample 98 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 100 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,61],Names=c("100","100","100","100","100")))
rownames(newRow)<-1:5

#combining sample 100 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 107 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,66],Names=c("107","107","107","107","107")))
rownames(newRow)<-1:5

#combining sample 107 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 115 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,69],Names=c("115","115","115","115","115")))
rownames(newRow)<-1:5

#combining sample 115 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 119 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,72],Names=c("119","119","119","119","119")))
rownames(newRow)<-1:5

#combining sample 119 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 141 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,82],Names=c("141","141","141","141","141")))
rownames(newRow)<-1:5

#combining sample 141 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 155 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,90],Names=c("155","155","155","155","155")))
rownames(newRow)<-1:5

#combining sample 155 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 163 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,95],Names=c("163","163","163","163","163")))
rownames(newRow)<-1:5

#combining sample 163 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 172 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,99],Names=c("172","172","172","172","172")))
rownames(newRow)<-1:5

#combining sample 172 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 178 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,102],Names=c("178","178","178","178","178")))
rownames(newRow)<-1:5

#combining sample 178 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 186 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,105],Names=c("186","186","186","186","186")))
rownames(newRow)<-1:5

#combining sample 186 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 193 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,108],Names=c("193","193","193","193","193")))
rownames(newRow)<-1:5

#combining sample 193 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 198 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,110],Names=c("198","198","198","198","198")))
rownames(newRow)<-1:5

#combining sample 198 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 199 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,111],Names=c("199","199","199","199","199")))
rownames(newRow)<-1:5

#combining sample 199 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 202 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,113],Names=c("202","202","202","202","202")))
rownames(newRow)<-1:5

#combining sample 202 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 207 expression
#newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,115],Names=c("207","207","207","207","207")))
#rownames(newRow)<-1:5

#combining sample 207 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202
#dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 211 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,118],Names=c("211","211","211","211","211")))
rownames(newRow)<-1:5

#combining sample 211 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                 #,207
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 216 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,122],Names=c("216","216","216","216","216")))
rownames(newRow)<-1:5

#combining sample 216 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198 199,202                                  #,207,211
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 219 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,123],Names=c("219","219","219","219","219")))
rownames(newRow)<-1:5

#combining sample 219 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 222 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,124],Names=c("222","222","222","222","222")))
rownames(newRow)<-1:5

#combining sample 222 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 230 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,128],Names=c("230","230","230","230","230")))
rownames(newRow)<-1:5

#combining sample 230 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 232 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,129],Names=c("232","232","232","232","232")))
rownames(newRow)<-1:5

#combining sample 232 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 236 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,131],Names=c("236","236","236","236","236")))
rownames(newRow)<-1:5

#combining sample 236 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 243 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,134],Names=c("243","243","243","243","243")))
rownames(newRow)<-1:5

#combining sample 243 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232,236
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 266 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,143],Names=c("266","266","266","266","266")))
rownames(newRow)<-1:5

#combining sample 266 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232,236,243
dataFiltered<- rbind(dataFiltered,newRow)

#creating data frame with sample 284 expression
#newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,147],Names=c("284","284","284","284","284")))
#rownames(newRow)<-1:5

#combining sample 284 and sample 16,22,25,28,38,40,44,47,64,65,68,71,72,83,95,98,100,107,115,119,141,155,163,172,178,186,193,198,199,202                                  #,207,211,216,219,222,230,232,236,243,266
#dataFiltered<- rbind(dataFiltered,newRow)
```

```{r Plotting zero}
#changing Expression values to be numeric 

dataFiltered$Expression<- as.numeric(dataFiltered$Expression)

#plotting all samples with FPKM 20 or less
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot
```

```{r TSPY1 gene expression}
#creating data frame of all samples with TSPY1 expression


#data frame sample 41 expression
dataFiltered<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,26],Names=c("041","041","041","041","041")))


#data frame sample 51 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,33],Names=c("051","051","051","051","051")))
rownames(newRow)<-1:5

#combining sample 41 and 51
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 53 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,35],Names=c("053","053","053","053","053")))
rownames(newRow)<-1:5

#combining sample 53 with sample 41,51
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 54 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,36],Names=c("054","054","054","054","054")))
rownames(newRow)<-1:5

#combining sample 54 with sample 41,51,53
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 79 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,51],Names=c("079","079","079","079","079")))
rownames(newRow)<-1:5

#combining sample 79 with sample 41,51,53,54
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 085 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,54],Names=c("085","085","085","085","085")))
rownames(newRow)<-1:5

#combining sample 85 with sample 41,51,53,54,79
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 101 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,62],Names=c("101","101","101","101","101")))
rownames(newRow)<-1:5

#combining sample 101 with sample 41,51,53,54,79,85
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 111 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,68],Names=c("111","111","111","111","111")))
rownames(newRow)<-1:5

#combining sample 111 with sample 41,51,53,54,79,85,101
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 149 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,86],Names=c("149","149","149","149","149")))
rownames(newRow)<-1:5

#combining sample 149 with sample 41,51,53,54,79,85,101,111
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 151 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,88],Names=c("151","151","151","151","151")))
rownames(newRow)<-1:5

#combining sample 151 with sample 41,51,53,54,79,85,101,111,149
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 167 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,97],Names=c("167","167","167","167","167")))
rownames(newRow)<-1:5

#combining sample 167 with sample 41,51,53,54,79,85,101,111,149,151
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 177 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,101],Names=c("177","177","177","177","177")))
rownames(newRow)<-1:5

#combining sample 177 with sample 41,51,53,54,79,85,101,111,149,151,167
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 189 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,106],Names=c("189","189","189","189","189")))
rownames(newRow)<-1:5

#combining sample 189 with sample 41,51,53,54,79,85,101,111,149,151,167,177
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 205 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,114],Names=c("205","205","205","205","205")))
rownames(newRow)<-1:5

#combining sample 205 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 209 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,116],Names=c("209","209","209","209","209")))
rownames(newRow)<-1:5

#combining sample 209 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189,205
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 223 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,125],Names=c("223","223","223","223","223")))
rownames(newRow)<-1:5

#combining sample 223 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189,205,209
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 256 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,135],Names=c("256","256","256","256","256")))
rownames(newRow)<-1:5

#combining sample 256 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189,205,209,223
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 265 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,142],Names=c("265","265","265","265","265")))
rownames(newRow)<-1:5

#combining sample 265 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189,205,209,223,256
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 277 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,146],Names=c("277","277","277","277","277")))
rownames(newRow)<-1:5

#combining sample 277 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189,205,209,223,256,265
dataFiltered<- rbind(dataFiltered,newRow)

#data frame sample 289 expression
newRow<- as.data.frame(cbind(genes=rownames(Tumor_expressionData),Expression=Tumor_expressionData[,149],Names=c("289","289","289","289","289")))
rownames(newRow)<-1:5

#combining sample 289 with sample 41,51,53,54,79,85,101,111,149,151,167,177,189,205,209,223,256,265,277
dataFiltered<- rbind(dataFiltered,newRow)
```

```{r Plotting zero}
#changing Expression values to be numeric 
dataFiltered$Expression<- as.numeric(dataFiltered$Expression)

#plotting all samples with TSPY1 expression
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot

#outputting PDF of plot
pdf("~/Desktop/ResearchProjects/LiverCancer/DEA_removed_samples/newFigures/TSPY1_expression_plot.pdf", width=12, height=12)
expressionPlot<- ggplot(data=dataFiltered, aes(x=genes,y=Expression,group=Names)) +  geom_line(aes(color=Names))+
  geom_point(aes(color=Names))
expressionPlot
dev.off()
```