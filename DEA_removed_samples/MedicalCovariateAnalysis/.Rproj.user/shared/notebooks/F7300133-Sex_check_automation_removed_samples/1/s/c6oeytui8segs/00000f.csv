"0",""
"0","#Storing hashmap as variable"
"0","h <- hash()"
"0",""
"0","#Pulling viral etiology designations from metadata"
"0","viralType <- metadataSubset$Virus_infection"
"0","viralType <- as.data.frame(viralType)"
"0",""
"0","#Renaming the column"
"0","colnames(viralType) <- c(""Virus"")"
"0",""
"0","# Pulling X degenerate expression data from dge variable into individual variables"
"0",""
"0","dge <- as.data.frame(dge)"
"0","gene0 <- dge[which(dge$gene_name==""KDM5D""),]"
"0","gene1 <- dge[which(dge$gene_name==""DDX3Y""),]"
"0","gene2 <- dge[which(dge$gene_name==""EIF1AY""),]"
"0","gene3 <- dge[which(dge$gene_name==""TXLNGY""),]"
"0","gene4 <- dge[which(dge$gene_name==""TSPY1""),]"
"0","gene5 <- dge[which(dge$gene_name==""AR""),]"
"0","gene6 <- dge[which(dge$gene_name==""XIST""),]"
"0",""
"0","#creating data frame of all genes we will be working with"
"0","xDegenerateExpression<- rbind(gene0,gene1,gene2,gene3,gene4,gene5,gene6)"
"0","#xDegenerateExpression<- t(xDegenerateExpression)"
"0","xDegenerateExpression<- as.data.frame(xDegenerateExpression)"
"0",""
"0","#Creating a hashmap that links the ensembl id to gene name of the X degenerate genes so the value is the ensembl id and the key is the gene name (if I ask for gene name it will report the ensembl id)"
"0","for (idx in 1:dim(xDegenerateExpression)[1]) {"
"0","     name <- xDegenerateExpression$gene_name[idx]"
"0","     ensembl_id <- xDegenerateExpression$GENEID[idx]"
"0","  if (ensembl_id %in% dge$GENEID) {   "
"0","       h[[name]] <- ensembl_id"
"0","  }"
"0","}"
"0",""
"0","#Creating the for loop so that all of the following steps will be done for each gene located in the hash map"
"0","for (gene in keys(h)) {"
"0",""
"0","  #setting the created hashmap into variable "
"0","  ensembl_id <- h[[gene]]"
"0","  "
"0","  #Pulling expression data from dge variable for the X degenerate genes "
"0","  expressionData <- dge[which(dge$GENEID== ensembl_id),]"
"0","  "
"0","  #subsetting out all columns that are not expression data"
"0","  expressionData <- subset(expressionData, select = -c(chr, start, end, TXNAME, GENEID, length, gene_name))"
"0","  expressionData <- t(expressionData)"
"0","  expressionData<- as.data.frame(expressionData)"
"0","  "
"0","  #Combining expression data and viral etiology designations "
"0","  expressionData <- cbind(expressionData,viralType)"
"0","  "
"0","  #Creating dataframe with the gene expression data and corresponding sample viral etiology "
"0","  #expressionData <- cbind(expressionData,viralType)"
"0","  "
"0","  #xDegenerateExpression<- as.data.frame(xDegenerateExpression)"
"0","  #xDegenerateExpression<- subset(xDegenerateExpression, select = -c(chr, start, end, TXNAME, GENEID, length, gene_name))"
"0","  "
"0","    #Subsetting by tumor samples"
"0","  Tumor_expressionData <- expressionData[grepl(""tumor"",rownames(expressionData),fixed=TRUE),]"
"0","  Tumor_expressionData <- as.data.frame(Tumor_expressionData)"
"0","  "
"0","  #Adding sample ids as rownames to tumor samples"
"0","  rownames(Tumor_expressionData) <- rownames(expressionData)[grepl(""tumor"",rownames(expressionData),fixed=TRUE)]"
"0","  "
"0","  #Subsetting by adjacent samples "
"0","  Adjacent_expressionData <- expressionData[grepl(""adjacent"",rownames(expressionData),fixed=TRUE),]"
"0","  Adjacent_expressionData <- as.data.frame(Adjacent_expressionData)"
"0","  "
"0","  #Adding sample ids as rownames to adjacent samples"
"0","  rownames(Adjacent_expressionData) <- rownames(expressionData)[grepl(""adjacent"",rownames(expressionData),fixed=TRUE)]"
"0","  "
"0","  #Creating new column that adds a 1 if the sample sex is Male and a 0 if the sample is female"
"0","  Tumor_expressionData$SexNumeric <- as.numeric(grepl(""XY"",rownames(Tumor_expressionData),fixed=TRUE))"
"0","  Adjacent_expressionData$SexNumeric <- as.numeric(grepl(""XY"",rownames(Adjacent_expressionData),fixed=TRUE))"
"0","  "
"0","  #Renaming columns"
"0","  colnames(Tumor_expressionData)<- c(""Expression"",""Virus"", ""SexNumeric"")"
"0","  "
"0","   #Creating a new column that as a 0 if the sample is male HBV, 1 if male HCV, 2 if female HBV, and 3 if female HCV "
"0","  Tumor_expressionData$SexViralNumeric <- ifelse(Tumor_expressionData$SexNumeric==""1"" & Tumor_expressionData$Virus==""HBV"", 0,"
"0","                                                 ifelse(Tumor_expressionData$SexNumeric==""1"" & Tumor_expressionData$Virus==""HCV"",1,"
"0","                                                        ifelse(Tumor_expressionData$SexNumeric==""0"" & Tumor_expressionData$Virus==""HBV"",2,3)))"
"0","  Adjacent_expressionData$SexViralNumeric <- ifelse(Adjacent_expressionData$SexNumeric==""1"" & Adjacent_expressionData$Virus==""HBV"", 0,"
"0","                                                 ifelse(Adjacent_expressionData$SexNumeric==""1"" & Adjacent_expressionData$Virus==""HCV"",1,"
"0","                                                        ifelse(Adjacent_expressionData$SexNumeric==""0"" &  Adjacent_expressionData$Virus==""HBV"",2,3)))"
"0",""
"0","  #For loop that adds the sample numbers in a new column called ""Names"""
"0","  for (i in 1:dim(Tumor_expressionData)[1]) {"
"0","    Tumor_expressionData$Names[i] = substr(row.names(Tumor_expressionData)[i],3,5)"
"0","  }"
"0","  "
"0","  for (i in 1:dim(Adjacent_expressionData)[1]) {"
"0","    Adjacent_expressionData$Names[i] = substr(row.names(Adjacent_expressionData)[i],3,5)"
"0","  }"
"0",""
"0","  #Renaming columns "
"0","  colnames(Tumor_expressionData)<- c(""Expression"",""Virus"", ""SexNumeric"",""SexViralNumeric"",""Names"")"
"0","  colnames(Adjacent_expressionData)<- c(""Expression"",""Virus"", ""SexNumeric"",""SexViralNumeric"",""Names"")"
"0","   "
"0","  #Creates a box plot of x degenerate gene expression data of all tumor samples "
"0","  pdf(paste(""~/Desktop/ResearchProjects/LiverCancerProject/DEA_removed_samples/newFigures/x_degenerate_tumor_gene_expression/"",gene,""_tumor_expression_data.pdf"",sep=""""), width=12, height=12)"
"0","  print(ggplot(Tumor_expressionData, aes(x=reorder(Names,SexViralNumeric),y= Expression,fill=SexViralNumeric)) + geom_bar(stat=""identity"", colour=""black"") +theme(axis.text.x = element_text(angle = 90, vjust = 0.75,hjust = 0.75, size=8)) +  scale_x_discrete(guide = guide_axis(n.dodge = 2))+ xlab(""Tumor Samples Expression data"") + labs(title=paste(gene,""Tumor Samples Expression Data"")))"
"0","  dev.off() "
"0","  "
"0","   #Creates a box plot of x degenerate expression data of all tumor  samples with x axis set to 500 to see lowly expressed values"
"0","  pdf(paste(""~/Desktop/ResearchProjects/LiverCancerProject/DEA_removed_samples/newFigures/x_degenerate_tumor_gene_expression/"",gene,""_tumor_expression_500Axis_data.pdf"",sep=""""), width=12, height=12)"
"0","  print(ggplot(Tumor_expressionData,aes(x=reorder(Names,SexViralNumeric),y= Expression,fill=SexViralNumeric)) + geom_bar(stat=""identity"", colour=""black"") +theme(axis.text.x = element_text(angle = 90, vjust = 0.75,hjust = 0.75, size=8)) +  scale_x_discrete(guide = guide_axis(n.dodge = 2))+ coord_cartesian(ylim=c(0,500))+xlab(""Tumor Samples Expression data"") + labs(title=paste(gene,""Tumor Samples Expression Data"")))"
"0","  dev.off() "
"0","  "
"0","  #Creates a box plot of x degenerate gene expression data of all tumor adjacent samples"
"0","  pdf(paste(""~/Desktop/ResearchProjects/LiverCancerProject/DEA_removed_samples/newFigures/x_degenerate_adjacent_gene_expression/"",gene,""_tumor_adjacent_expression_data.pdf"",sep=""""), width=12, height=12)"
"0","  print(ggplot(Adjacent_expressionData,aes(x=reorder(Names,SexViralNumeric),y= Expression,fill=SexViralNumeric)) + geom_bar(stat=""identity"", colour=""black"") +theme(axis.text.x = element_text(angle = 90, vjust = 0.75,hjust = 0.75, size=8)) +  scale_x_discrete(guide = guide_axis(n.dodge = 2))+ xlab(""Adjacent Samples Expression data"") + labs(title=paste(gene,""Tumor Adjacent Samples Expression Data"")))"
"0","  dev.off() "
"0","  "
"0","    #Creates a box plot of x degenerate gene expression data of all tumor adjacent samples  with x axis set to 500 to see lowly expressed values"
"0","  pdf(paste(""~/Desktop/ResearchProjects/LiverCancerProject/DEA_removed_samples/newFigures/x_degenerate_adjacent_gene_expression/"",gene,""_tumor_adjacent_expression_500Axis_data.pdf"",sep=""""), width=12, height=12)"
"0","  print(ggplot(Adjacent_expressionData,aes(x=reorder(Names,SexViralNumeric),y= Expression,fill=SexViralNumeric)) + geom_bar(stat=""identity"", colour=""black"") +theme(axis.text.x = element_text(angle = 90, vjust = 0.75,hjust = 0.75, size=8)) +  scale_x_discrete(guide = guide_axis(n.dodge = 2))+ coord_cartesian(ylim=c(0,500))+xlab(""Adjacent Samples Expression data"") + labs(title=paste(gene,""Tumor Adjacent Samples Expression Data"")))"
"0","  dev.off() "
"0",""
"0","}"
"0",""
"0",""
