"0","# ======================================"
"0","# Filtering expression data"
"0","# ======================================"
"0",""
"0","# Keeping genes that have a mean FPKM of at least 0.5 in at least one of the"
"0","# groups under investigation and at least 6 reads in at least 10 samples"
"0","fpkm <- rpkm(dge, gene.length=dge$genes$length)"
"0",""
"0","M_1_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""M_1_HBV"")],1,mean,na.rm=TRUE)"
"0","M_0_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""M_0_HBV"")],1,mean,na.rm=TRUE)"
"0","M_1_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""M_1_HCV"")],1,mean,na.rm=TRUE)"
"0","M_0_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""M_0_HCV"")],1,mean,na.rm=TRUE)"
"0",""
"0","F_1_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""F_1_HBV"")],1,mean,na.rm=TRUE)"
"0","F_0_HBV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""F_0_HBV"")],1,mean,na.rm=TRUE)"
"0","F_1_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""F_1_HCV"")],1,mean,na.rm=TRUE)"
"0","F_0_HCV_mean_fpkm <- apply(as.data.frame(fpkm)[(dge$samples$gender_tissue_viral==""F_0_HCV"")],1,mean,na.rm=TRUE)"
"0",""
"0","keep <- (M_1_HBV_mean_fpkm > 0.5 | M_0_HBV_mean_fpkm > 0.5 | "
"0","           M_1_HCV_mean_fpkm > 0.5 | M_0_HCV_mean_fpkm > 0.5 |"
"0","           F_1_HBV_mean_fpkm > 0.5 | F_0_HBV_mean_fpkm > 0.5 |"
"0","           F_1_HCV_mean_fpkm > 0.5 | F_0_HCV_mean_fpkm > 0.5 )"
"0",""
"0","dge <- dge[keep,,keep.lib.sizes=FALSE]"
"0","dge <- calcNormFactors(dge, method=""TMM"")"
"0","keep <- rowSums(dge$counts > 6) >= 10"
"0","dge <- dge[keep,,keep.lib.size=FALSE]"
"0","dge <- calcNormFactors(dge, method=""TMM"")"
"0",""
"0","# N of genes retained after filtering"
"0","dim(dge$genes)"
"1","[1]"
"1"," 12465"
"1","     7"
"1","
"
